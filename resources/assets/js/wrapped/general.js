"use strict";function hideItemAutocomplete(){itemAutocompleteCached.resultsContainer.children().length>0&&(itemAutocompleteCached.resultsContainer.html(""),itemAutocompleteCached.resultsContainer.css("visibility","hidden"))}function getItem(){var e=itemAutocompleteCached.input.val();""!==$.trim(e)&&(itemAutocompleteCached.resultsContainer.html(itemAutocompleteCached.loading),itemAutocompleteCached.resultsContainer.css("visibility","visible"),$.ajax({url:"/item/find",data:{name:e},success:function(e){0===e.length?itemAutocompleteCached.resultsContainer.html('<p class="nowrap">Nothing found, which means we don\'t have it in our database yet. We do our best to fill it as much as possible to open more trading opportunities, so please try again later, we might have it by the time.</p>'):(itemAutocompleteCached.resultsContainer.html(""),itemAutocompleteCached.countingSearchResults.length=0,$.each(e,function(e,t){itemAutocompleteCached.countingSearchResults.push(e),"mod"===t.type?$('<li data-type="'+t.type+'" data-name="'+t.name+'">'+t.name+" (mod)</li>").appendTo(itemAutocompleteCached.resultsContainer):$('<li data-type="'+t.type+'" data-name="'+t.name+'">'+t.name+"</li>").appendTo(itemAutocompleteCached.resultsContainer),$(".sell-item-name-search-results li").hover(function(){$(".sell-item-name-search-results li").hasClass("js-sell-item-name-search-result-hover")&&$(".sell-item-name-search-results li").removeClass("js-sell-item-name-search-result-hover")}).click(function(){itemAutocompleteCached.input.val($(this).attr("data-name")),"mod"===$(this).attr("data-type")?$(".sell_item_rank_fieldset[disabled]").removeAttr("disabled"):$(".sell_item_rank_fieldset").attr("disabled","disabled"),hideItemAutocomplete()})}))},error:function(){itemAutocompleteCached.resultsContainer.html('<p class="nowrap">It seems that our database is busy right now. Please try again later.</p>')}}))}function hideOfferAutocomplete(){offerAutocompleteCached.resultsContainer.children().length>0&&(offerAutocompleteCached.resultsContainer.html(""),offerAutocompleteCached.resultsContainer.css("visibility","hidden"))}function getOffer(){var e=offerAutocompleteCached.input.val();""!==$.trim(e)&&(offerAutocompleteCached.resultsContainer.html(offerAutocompleteCached.loading),offerAutocompleteCached.resultsContainer.css("visibility","visible"),$.ajax({url:"/item/find",data:{name:e},success:function(e){0===e.length?offerAutocompleteCached.resultsContainer.html('<p class="nowrap">Nothing found, which means we don\'t have it in our database yet. We do our best to fill it as much as possible to open more trading opportunities, so please try again later, we might have it by the time.</p>'):(offerAutocompleteCached.resultsContainer.html(""),offerAutocompleteCached.countingSearchResults.length=0,$.each(e,function(e,t){offerAutocompleteCached.countingSearchResults.push(e),"mod"===t.type?$('<li data-platform="'+offerAutocompleteCached.platform.val()+'" data-slug="'+t.slug+'">'+t.name+" (mod)</li>").appendTo(offerAutocompleteCached.resultsContainer):$('<li data-platform="'+offerAutocompleteCached.platform.val()+'" data-slug="'+t.slug+'">'+t.name+"</li>").appendTo(offerAutocompleteCached.resultsContainer),$(".offer-item-name-search-results li").hover(function(){$(".offer-item-name-search-results li").hasClass("js-offer-item-name-search-result-hover")&&$(".offer-item-name-search-results li").removeClass("js-offer-item-name-search-result-hover")}).click(function(){window.location="/"+$(this).attr("data-platform")+"/"+$(this).attr("data-slug")})}))},error:function(){offerAutocompleteCached.resultsContainer.html('<p class="nowrap">It seems that our database is busy right now. Please try again later.</p>')}}))}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var ajaxFormSubmit=function(e,t,a,r,o,s,n,l,i,c,u){var m=$(e),f=m.css("height");t.fadeOut(200,function(){$(e+" .alert-danger").remove(),m.css("height",f).animate({height:"57px"},200),$(e+" > .continer-fluid").append('<div class="loading"></div>'),$(".loading").fadeIn(200),$.ajax({url:a,type:"POST",data:t.serialize(),success:function(a){var c;a!==o?t.hasClass("js-account-signed")||"Registered."===a?window.location.reload():($(".loading").fadeOut(200),$(s+" "+r).fadeOut(200),$(s+" .btn-default").fadeOut(200,function(){$(this).text("Close").fadeIn(200)}),$(s+" "+r).remove(),$(".loading").remove(),m.append('<div class="alert alert-success" role="alert">'+n+"</div>"),l===!0&&m.append('<div class="well"><h4>'+a+"</h4></div>"),m.removeAttr("style"),c=m.css("height"),$(e+" .alert-success").css("display","none"),$(e+" .well").css("display","none"),m.animate({height:c},200),$(e+" .alert-success").fadeIn(200),l===!0&&$(e+" .well").fadeIn(200),"undefined"!=typeof u&&u()):($(".loading").fadeOut(200),m.append('<div class="alert alert-danger" role="alert">'+i+"</div>").removeAttr("style"),$(".loading").remove(),t.css("display","block"),c=m.css("height"),t.css("display","none"),$(e+" .alert-danger").css("display","none"),m.animate({height:c},200),t.fadeIn(200),$(e+" .alert-danger").fadeIn(200))},error:function(a){var r;if($(".loading").fadeOut(200),c===!0)if(422===a.status){for(var o in a.responseJSON){m.append('<div class="alert alert-danger" role="alert">'+a.responseJSON[o][0]+"</div>");break}m.removeAttr("style"),$(".loading").remove(),t.css("display","block"),r=m.css("height"),t.css("display","none"),$(e+" .alert-danger").css("display","none"),m.animate({height:r},200),t.fadeIn(200),$(e+" .alert-danger").fadeIn(200)}else m.append('<div class="alert alert-danger" role="alert">It seems that our database is busy right now. Please try again later.</div>').removeAttr("style"),$(".loading").remove(),t.css("display","block"),r=m.css("height"),t.css("display","none"),$(e+" .alert-danger").css("display","none"),m.animate({height:r},200),t.fadeIn(200),$(e+" .alert-danger").fadeIn(200);else m.append('<div class="alert alert-danger" role="alert">It seems that our database is busy right now. Please try again later.</div>').removeAttr("style"),$(".loading").remove(),t.css("display","block"),r=m.css("height"),t.css("display","none"),$(e+" .alert-danger").css("display","none"),m.animate({height:r},200),t.fadeIn(200),$(e+" .alert-danger").fadeIn(200)}})})},itemAutocompleteCached={input:$("#sell_item_name"),resultsContainer:$(".sell-item-name-search-results"),loading:'<div class="loading"></div>',countingSearchResults:[]};$(".modal-content").click(function(){0===$(".sell-item-name-search-results li:hover").length&&hideItemAutocomplete()});var itemAutocompleteKeyUpCached={resultsItem:null,resultsLength:null,delay:null};itemAutocompleteCached.input.keyup(function(e){switch(e.keyCode){case 40:itemAutocompleteKeyUpCached.resultsItem=$(".sell-item-name-search-results li"),itemAutocompleteKeyUpCached.resultsLength=itemAutocompleteCached.countingSearchResults.length;for(var t=0;t<itemAutocompleteKeyUpCached.resultsLength;t++){if("js-sell-item-name-search-result-hover"===itemAutocompleteCached.countingSearchResults[t]){if(t===itemAutocompleteKeyUpCached.resultsLength-1){itemAutocompleteCached.countingSearchResults[t]=t,itemAutocompleteKeyUpCached.resultsItem.eq(t).removeClass("js-sell-item-name-search-result-hover"),itemAutocompleteCached.countingSearchResults[0]="js-sell-item-name-search-result-hover",itemAutocompleteKeyUpCached.resultsItem.eq(0).addClass("js-sell-item-name-search-result-hover");break}itemAutocompleteCached.countingSearchResults[t]=t,itemAutocompleteKeyUpCached.resultsItem.eq(t).removeClass("js-sell-item-name-search-result-hover"),itemAutocompleteCached.countingSearchResults[t+1]="js-sell-item-name-search-result-hover",itemAutocompleteKeyUpCached.resultsItem.eq(t+1).addClass("js-sell-item-name-search-result-hover");break}if(t===itemAutocompleteKeyUpCached.resultsLength-1){itemAutocompleteCached.countingSearchResults[0]="js-sell-item-name-search-result-hover",itemAutocompleteKeyUpCached.resultsItem.eq(0).addClass("js-sell-item-name-search-result-hover");break}}break;case 38:itemAutocompleteKeyUpCached.resultsItem=$(".sell-item-name-search-results li"),itemAutocompleteKeyUpCached.resultsLength=itemAutocompleteCached.countingSearchResults.length;for(var a=0;a<itemAutocompleteKeyUpCached.resultsLength;a++){if("js-sell-item-name-search-result-hover"===itemAutocompleteCached.countingSearchResults[a]){if(0===a){itemAutocompleteCached.countingSearchResults[a]=a,itemAutocompleteKeyUpCached.resultsItem.eq(a).removeClass("js-sell-item-name-search-result-hover"),itemAutocompleteCached.countingSearchResults[itemAutocompleteKeyUpCached.resultsLength-1]="js-sell-item-name-search-result-hover",itemAutocompleteKeyUpCached.resultsItem.eq(itemAutocompleteKeyUpCached.resultsLength-1).addClass("js-sell-item-name-search-result-hover");break}itemAutocompleteCached.countingSearchResults[a]=a,itemAutocompleteKeyUpCached.resultsItem.eq(a).removeClass("js-sell-item-name-search-result-hover"),itemAutocompleteCached.countingSearchResults[a-1]="js-sell-item-name-search-result-hover",itemAutocompleteKeyUpCached.resultsItem.eq(a-1).addClass("js-sell-item-name-search-result-hover");break}if(a===itemAutocompleteKeyUpCached.resultsLength-1){itemAutocompleteCached.countingSearchResults[itemAutocompleteKeyUpCached.resultsLength-1]="js-sell-item-name-search-result-hover",itemAutocompleteKeyUpCached.resultsItem.eq(itemAutocompleteKeyUpCached.resultsLength-1).addClass("js-sell-item-name-search-result-hover");break}}break;case 13:$(".sell-item-name-search-results li").hasClass("js-sell-item-name-search-result-hover")&&(itemAutocompleteCached.input.val($(".sell-item-name-search-results li.js-sell-item-name-search-result-hover").attr("data-name")),"mod"===$(".sell-item-name-search-results li.js-sell-item-name-search-result-hover").attr("data-type")?$(".sell_item_rank_fieldset[disabled]").removeAttr("disabled"):$(".sell_item_rank_fieldset").attr("disabled","disabled"),hideItemAutocomplete());break;default:itemAutocompleteKeyUpCached.delay&&clearTimeout(itemAutocompleteKeyUpCached.delay),itemAutocompleteKeyUpCached.delay=setTimeout(getItem,500)}});var guestOfferFormVariables={modal:".js-modal-create",form:$(".sell_item_form"),url:"/offer/publish/guest",actionButton:".btn-primary",error:"Doesn't exist.",modalFooter:".js-modal-footer-create",successText:"You're live. <mark>Write down the code below</mark>—you'll need it to remove your offer after a successful trade; it's your communal responsibility to do so, please keep our tables clean. Your offer will automatically be removed in 3 days.<br><br>Please refresh the page to add another offer.",errorText:"The item you're trying to sell doesn't exist in our database. Please check the item's name, or come back later, we might have it by the time."};$(".sell_item_form_submit").click(function(){guestOfferFormVariables.form.submit()}),guestOfferFormVariables.form.validator().submit(function(e){e.isDefaultPrevented()||($(".sell_item_rank_fieldset[disabled]").length>0&&guestOfferFormVariables.form.append('<input type="hidden" name="sell_item_rank" value="11">'),e.preventDefault(),ajaxFormSubmit(guestOfferFormVariables.modal,guestOfferFormVariables.form,guestOfferFormVariables.url,guestOfferFormVariables.actionButton,guestOfferFormVariables.error,guestOfferFormVariables.modalFooter,guestOfferFormVariables.successText,!0,guestOfferFormVariables.errorText,!0))});var userOfferFormVariables={modal:".js-modal-create",form:$(".sell_item_form_authed"),url:"/offer/publish/user",actionButton:".btn-primary",error:"Doesn't exist.",modalFooter:".js-modal-footer-create",successText:"",errorText:"The item you're trying to sell doesn't exist in our database. Please check the item's name, or come back later, we might have it by the time."};$(".sell_item_form_submit_authed").click(function(){userOfferFormVariables.form.submit()}),userOfferFormVariables.form.validator().submit(function(e){e.isDefaultPrevented()||($(".sell_item_rank_fieldset[disabled]").length>0&&userOfferFormVariables.form.append('<input type="hidden" name="sell_item_rank" value="11">'),userOfferFormVariables.form.append('<input type="hidden" name="sell_user_ign" value="'+$("#user_ign").val()+'">'),e.preventDefault(),ajaxFormSubmit(userOfferFormVariables.modal,userOfferFormVariables.form,userOfferFormVariables.url,userOfferFormVariables.actionButton,userOfferFormVariables.error,userOfferFormVariables.modalFooter,userOfferFormVariables.successText,!0,userOfferFormVariables.errorText,!0))});var removeOfferFormVariables={modal:".js-modal-remove",form:$(".remove_offer_form"),url:"/offer/remove",actionButton:".btn-warning",error:"Doesn't exist.",modalFooter:".js-modal-footer-remove",successText:"Your offer was successfully removed. Please refresh the page to remove another offer.",errorText:"An offer with that code doesn't exist. You either deleted it already, or it was removed automatically after 3 days of publishing."};$(".remove_offer_form_submit").click(function(){removeOfferFormVariables.form.submit()}),removeOfferFormVariables.form.validator().submit(function(e){e.isDefaultPrevented()||(e.preventDefault(),ajaxFormSubmit(removeOfferFormVariables.modal,removeOfferFormVariables.form,removeOfferFormVariables.url,removeOfferFormVariables.actionButton,removeOfferFormVariables.error,removeOfferFormVariables.modalFooter,removeOfferFormVariables.successText,!1,removeOfferFormVariables.errorText,!1))});var offerAutocompleteCached={input:$("#offer_item_name"),platform:$("#offer_item_platform"),resultsContainer:$(".offer-item-name-search-results"),loading:'<div class="loading"></div>',countingSearchResults:[]};$("html").click(function(){0===$(".offer-item-name-search-results li:hover").length&&hideOfferAutocomplete()});var offerAutocompleteKeyUpCached={resultsItem:null,resultsLength:null,delay:null};offerAutocompleteCached.input.keyup(function(e){switch(e.keyCode){case 40:offerAutocompleteKeyUpCached.resultsItem=$(".offer-item-name-search-results li"),offerAutocompleteKeyUpCached.resultsLength=offerAutocompleteCached.countingSearchResults.length;for(var t=0;t<offerAutocompleteKeyUpCached.resultsLength;t++){if("js-offer-item-name-search-result-hover"===offerAutocompleteCached.countingSearchResults[t]){if(t===offerAutocompleteKeyUpCached.resultsLength-1){offerAutocompleteCached.countingSearchResults[t]=t,offerAutocompleteKeyUpCached.resultsItem.eq(t).removeClass("js-offer-item-name-search-result-hover"),offerAutocompleteCached.countingSearchResults[0]="js-offer-item-name-search-result-hover",offerAutocompleteKeyUpCached.resultsItem.eq(0).addClass("js-offer-item-name-search-result-hover");break}offerAutocompleteCached.countingSearchResults[t]=t,offerAutocompleteKeyUpCached.resultsItem.eq(t).removeClass("js-offer-item-name-search-result-hover"),offerAutocompleteCached.countingSearchResults[t+1]="js-offer-item-name-search-result-hover",offerAutocompleteKeyUpCached.resultsItem.eq(t+1).addClass("js-offer-item-name-search-result-hover");break}if(t===offerAutocompleteKeyUpCached.resultsLength-1){offerAutocompleteCached.countingSearchResults[0]="js-offer-item-name-search-result-hover",offerAutocompleteKeyUpCached.resultsItem.eq(0).addClass("js-offer-item-name-search-result-hover");break}}break;case 38:offerAutocompleteKeyUpCached.resultsItem=$(".offer-item-name-search-results li"),offerAutocompleteKeyUpCached.resultsLength=offerAutocompleteCached.countingSearchResults.length;for(var a=0;a<offerAutocompleteKeyUpCached.resultsLength;a++){if("js-offer-item-name-search-result-hover"===offerAutocompleteCached.countingSearchResults[a]){if(0===a){offerAutocompleteCached.countingSearchResults[a]=a,offerAutocompleteKeyUpCached.resultsItem.eq(a).removeClass("js-offer-item-name-search-result-hover"),offerAutocompleteCached.countingSearchResults[offerAutocompleteKeyUpCached.resultsLength-1]="js-offer-item-name-search-result-hover",offerAutocompleteKeyUpCached.resultsItem.eq(offerAutocompleteKeyUpCached.resultsLength-1).addClass("js-offer-item-name-search-result-hover");break}offerAutocompleteCached.countingSearchResults[a]=a,offerAutocompleteKeyUpCached.resultsItem.eq(a).removeClass("js-offer-item-name-search-result-hover"),offerAutocompleteCached.countingSearchResults[a-1]="js-offer-item-name-search-result-hover",offerAutocompleteKeyUpCached.resultsItem.eq(a-1).addClass("js-offer-item-name-search-result-hover");break}if(a===offerAutocompleteKeyUpCached.resultsLength-1){offerAutocompleteCached.countingSearchResults[offerAutocompleteKeyUpCached.resultsLength-1]="js-offer-item-name-search-result-hover",offerAutocompleteKeyUpCached.resultsItem.eq(offerAutocompleteKeyUpCached.resultsLength-1).addClass("js-offer-item-name-search-result-hover");break}}break;case 13:$(".offer-item-name-search-results li").hasClass("js-offer-item-name-search-result-hover")&&(window.location="/"+$(".offer-item-name-search-results li.js-offer-item-name-search-result-hover").attr("data-platform")+"/"+$(".offer-item-name-search-results li.js-offer-item-name-search-result-hover").attr("data-slug"));break;default:offerAutocompleteKeyUpCached.delay&&clearTimeout(offerAutocompleteKeyUpCached.delay),offerAutocompleteKeyUpCached.delay=setTimeout(getOffer,500)}});var createAccountFormVariables={modal:".js-modal-create-account",form:$(".create_account_form"),url:"/account/register",actionButton:".btn-primary",error:null,modalFooter:".js-modal-footer-create-account",successText:'Your account was successfully created; <a href="#" class="js-login-after-creation">click here</a> to sign in.',errorText:null};$(".create_account_form_submit").click(function(){createAccountFormVariables.form.submit()}),createAccountFormVariables.form.validator().submit(function(e){e.isDefaultPrevented()||(e.preventDefault(),ajaxFormSubmit(createAccountFormVariables.modal,createAccountFormVariables.form,createAccountFormVariables.url,createAccountFormVariables.actionButton,createAccountFormVariables.error,createAccountFormVariables.modalFooter,createAccountFormVariables.successText,!1,createAccountFormVariables.errorText,!0,function(){$(".js-login-after-creation").click(function(e){e.preventDefault(),$("#createAccount").modal("hide"),$("#accountSignIn").modal("show")})}))});var accountSignInFormVariables={modal:".js-modal-account-sign-in",form:$(".account_sign_in_form"),errorText:"The ID and password didn’t match. Please check the credentials you entered or try again with a different combination."};$(".account_sign_in_form_submit").click(function(){accountSignInFormVariables.form.submit()}),accountSignInFormVariables.form.validator().submit(function(e){if(!e.isDefaultPrevented()){e.preventDefault();var t=$(accountSignInFormVariables.modal),a=t.css("height");accountSignInFormVariables.form.fadeOut(200,function(){$(accountSignInFormVariables.modal+" .alert-danger").remove(),t.css("height",a).animate({height:"57px"},200),$(accountSignInFormVariables.modal+" > .continer-fluid").append('<div class="loading"></div>'),$(".loading").fadeIn(200),$.ajax({url:"/account/login",type:"POST",data:accountSignInFormVariables.form.serialize(),success:function(e){if("Exists."===e)window.location="/";else{var a;$(".loading").fadeOut(200),t.append('<div class="alert alert-danger" role="alert">'+accountSignInFormVariables.errorText+"</div>").removeAttr("style"),$(".loading").remove(),accountSignInFormVariables.form.css("display","block"),a=t.css("height"),accountSignInFormVariables.form.css("display","none"),$(accountSignInFormVariables.modal+" .alert-danger").css("display","none"),t.animate({height:a},200),accountSignInFormVariables.form.fadeIn(200),$(accountSignInFormVariables.modal+" .alert-danger").fadeIn(200)}},error:function(){var e;if($(".loading").fadeOut(200),422===response.status){for(var a in response.responseJSON){t.append('<div class="alert alert-danger" role="alert">'+response.responseJSON[a][0]+"</div>");break}t.removeAttr("style"),$(".loading").remove(),accountSignInFormVariables.form.css("display","block"),e=t.css("height"),accountSignInFormVariables.form.css("display","none"),$(accountSignInFormVariables.modal+" .alert-danger").css("display","none"),t.animate({height:e},200),accountSignInFormVariables.form.fadeIn(200),$(accountSignInFormVariables.modal+" .alert-danger").fadeIn(200)}else t.append('<div class="alert alert-danger" role="alert">It seems that our database is busy right now. Please try again later.</div>').removeAttr("style"),$(".loading").remove(),accountSignInFormVariables.form.css("display","block"),e=t.css("height"),accountSignInFormVariables.form.css("display","none"),$(accountSignInFormVariables.modal+" .alert-danger").css("display","none"),t.animate({height:e},200),accountSignInFormVariables.form.fadeIn(200),$(accountSignInFormVariables.modal+" .alert-danger").fadeIn(200)}})})}});var userOnlineStatusCheckbox=$('input[name="js-user-online-status"]'),userOnlineStatusAjaxCall=function(e){var t,a=$(".js-user-online-description");t=e===!0?"/user/status/online":"/user/status/offline",$.ajax({url:t,type:"GET",success:function(e){"Online."===e?a.fadeOut(200,function(){a.text("You're playing and can trade."),a.fadeIn(200)}):"Offline."===e?a.fadeOut(200,function(){a.text("You're not in the game and unavailable for trading."),a.fadeIn(200)}):(a.fadeOut(200,function(){a.text("There's something wrong, please try again later."),a.fadeIn(200)}),userOnlineStatusCheckbox.bootstrapSwitch("toggleIndeterminate"))},error:function(){a.fadeOut(200,function(){a.text("There's something wrong, please try again later."),a.fadeIn(200)}),userOnlineStatusCheckbox.bootstrapSwitch("toggleIndeterminate")}})};userOnlineStatusCheckbox.hasClass("js-user-online-status-1")?userOnlineStatusCheckbox.bootstrapSwitch({state:!0,onColor:"success",offColor:"danger",onText:"ONLINE",offText:"OFFLINE",size:"mini"}).on("switchChange.bootstrapSwitch",function(e,t){userOnlineStatusAjaxCall(t)}):userOnlineStatusCheckbox.bootstrapSwitch({state:!1,onColor:"success",offColor:"danger",onText:"ONLINE",offText:"OFFLINE",size:"mini"}).on("switchChange.bootstrapSwitch",function(e,t){userOnlineStatusAjaxCall(t)});var popoverAccountBenefitsContents="<p>Account is just a convenience to players who sell a lot of items at the same time, so you might not need it at all. With an account you're be able to:</p>";popoverAccountBenefitsContents+='<ul class="dojo-popover-ul">',popoverAccountBenefitsContents+="<li>see all your offers in one place;</li>",popoverAccountBenefitsContents+="<li>change their price and commentary;</li>",popoverAccountBenefitsContents+="<li>renew all or some of your offers instead of creating them over and over again.</li>",popoverAccountBenefitsContents+="</ul>",$(".js-popover-account-creation").popover({html:!0,placement:"top",trigger:"hover",content:popoverAccountBenefitsContents}).click(function(e){e.preventDefault()}),$(".js-popover-account-offers-status").popover({placement:"top",trigger:"hover",content:"All offers are automatically removed from tables after 3 days of publishing. Offers that were published by guest users are deleted; offers that were published by registered accounts are expired instead—this lets such users to renew their expired offers without having to fill in the publishing form over and over again."}).click(function(e){e.preventDefault()}),$(".js-popover-missing-item").popover({placement:"top",trigger:"focus",html:!0,content:'Can\'t find an item? Add it to the "raw" sheet of this <a href="https://docs.google.com/spreadsheets/d/15K2ZRFk34HqUNRJFJ5H6Gc-axgetOagBpCXD1wYY75w/edit?usp=sharing">Google spreadsheet</a>, and we\'ll update our database with your changes very soon. Alternatively, you can always <a href="mailto:dojo.trade.wf@gmail.com">send us</a> a message.'});var popoverRecentOffersContents='<div class="btn-group" role="group" aria-label="...">';popoverRecentOffersContents+='<a class="btn btn-default navbar-btn" href="/offers/recent/pc" role="button">PC</a>',popoverRecentOffersContents+='<a class="btn btn-default navbar-btn" href="/offers/recent/ps4" role="button">PS4</a>',popoverRecentOffersContents+='<a class="btn btn-default navbar-btn" href="/offers/recent/xbox-one" role="button">Xbox One</a>',popoverRecentOffersContents+="</div>",$(".js-popover-recent-offers").popover({container:"body",placement:"bottom",trigger:"focus",html:!0,content:popoverRecentOffersContents}).click(function(e){e.preventDefault()}),$(".js-popover-new-messages").popover({container:"body",placement:"top",trigger:"manual",content:"Inbox messages await the Operator."}).popover("show");var popoverUserOnlineStatusContents="<p>If you'd like Trading Dojo to show that you're playing and can trade:</p>";popoverUserOnlineStatusContents+='<ol class="dojo-popover-ol">',popoverUserOnlineStatusContents+="<li>launch the game and log in;</li>",popoverUserOnlineStatusContents+="<li>flip this switch on Trading Dojo;</li>",popoverUserOnlineStatusContents+="<li>flip the switch back when you're done playing.</li>",popoverUserOnlineStatusContents+="</ol>",popoverUserOnlineStatusContents+="<p><mark>Please note that your online status will automatically turn offline in 8 hours after going online, and you'll need to switch it on again.</mark></p>",popoverUserOnlineStatusContents+="<p>Unfortunately, there's no better way to show your online status.</p>",$(".bootstrap-switch").popover({container:"body",placement:"bottom",trigger:"hover",html:!0,content:popoverUserOnlineStatusContents}),$(".js-popover-user-online-status-color").popover({container:"body",placement:"top",trigger:"hover",content:"Green color means they're currently in the game; blue means we don't know."}),$(".js-account-offers-table").editableTableWidget(),$('td[data-editable="true"]').on("validate",function(e,t){var a=$(this),r=a.index();if(1===r){if(""===t||!$.isNumeric(t)||1>t)return!1}else if(3===r)return t.length>250?!1:""===t?"":t.trim()});var editableTableWidgetAjaxCall=function(e){$.ajax({url:"/offer/update",data:e,type:"POST",success:function(e){$("#updateSignedOfferCall").modal("hide"),setTimeout(function(){$("#updateSignedOfferDone").modal("show")},300)},error:function(){$("#updateSignedOfferCall").modal("hide"),setTimeout(function(){$("#updateSignedOfferError").modal("show")},300)}})};$('td[data-editable="true"]').on("change",function(e,t){var a=$(this),r=a.index(),o=a.attr("data-id");$("#updateSignedOfferCall").modal({keyboard:!1,backdrop:"static"}),1===r?editableTableWidgetAjaxCall({sell_item_price:t,sell_item_id:o}):3===r&&editableTableWidgetAjaxCall({sell_item_commentary:t,sell_item_id:o})}),$("tr").hover(function(){var e=$(this);e.find("td").eq(5).find(".js-account-offer-table-button").removeClass("invisible")},function(){var e=$(this);e.find("td").eq(5).find(".js-account-offer-table-button").addClass("invisible")}),$(".js-account-offer-remove").click(function(e){e.preventDefault();var t=$(this),a=t.parent(),r=a.parent(),o=a.attr("data-id");$.ajax({url:"/offer/remove",data:{sell_item_id:o},type:"POST",success:function(e){$("#updateSignedOfferCall").modal("hide"),"Removed."===e?(setTimeout(function(){$("#removeSignedOfferSuccess").modal("show")},300),r.addClass("danger"),r.fadeOut(200)):setTimeout(function(){$("#removeSignedOfferError").modal("show")},300)},error:function(){$("#updateSignedOfferCall").modal("hide"),setTimeout(function(){$("#updateSignedOfferError").modal("show")},300)}})}),$(".js-account-offer-expire").click(function(e){e.preventDefault();var t=$(this),a=t.parent(),r=(a.parent(),a.attr("data-id"));$.ajax({url:"/offer/expire",data:{sell_item_id:r},type:"POST",success:function(e){$("#updateSignedOfferCall").modal("hide"),"Expired."===e?window.location="/":setTimeout(function(){$("#renewSignedOfferError").modal("show")},300)},error:function(){$("#updateSignedOfferCall").modal("hide"),setTimeout(function(){$("#updateSignedOfferError").modal("show")},300)}})}),$(".js-account-offer-renew").click(function(e){e.preventDefault();var t=$(this),a=t.parent(),r=(a.parent(),a.attr("data-id"));$.ajax({url:"/offer/renew",data:{sell_item_id:r},type:"POST",success:function(e){$("#updateSignedOfferCall").modal("hide"),"Renewed."===e?window.location.reload():setTimeout(function(){$("#renewSignedOfferError").modal("show")},300)},error:function(){$("#updateSignedOfferCall").modal("hide"),setTimeout(function(){$("#updateSignedOfferError").modal("show")},300)}})}),$(".js-account-offer-renew-all").click(function(e){e.preventDefault(),$.ajax({url:"/offer/renew/all",type:"GET",success:function(e){$("#updateSignedOfferCall").modal("hide"),"Renewed."===e?window.location="/":setTimeout(function(){$("#renewSignedOfferError").modal("show")},300)},error:function(){$("#updateSignedOfferCall").modal("hide"),setTimeout(function(){$("#updateSignedOfferError").modal("show")},300)}})});var sendMessageVariables={modal:".js-modal-send",form:$(".send_message_form"),url:"/messages/send/store",actionButton:".btn-primary",error:"Unauthorized.",modalFooter:".js-modal-footer-send",successText:'Sent! <a href="/messages">Here\'s a quick access</a> to your inbox, in case you want to see your message.',errorText:"Please sign in first."};if($(".send_message_form_submit").click(function(){sendMessageVariables.form.submit()}),sendMessageVariables.form.validator().submit(function(e){e.isDefaultPrevented()||(sendMessageVariables.form.append('<input type="hidden" name="recipient[]" value="'+$("#recepient").attr("data-id")+'">'),e.preventDefault(),ajaxFormSubmit(sendMessageVariables.modal,sendMessageVariables.form,sendMessageVariables.url,sendMessageVariables.actionButton,sendMessageVariables.error,sendMessageVariables.modalFooter,sendMessageVariables.successText,!1,sendMessageVariables.errorText,!0))}),$(".js-messages-remove").hover(function(){var e=$(this);e.find("a.btn").removeClass("invisible")},function(){var e=$(this);e.find("a.btn").addClass("invisible")}),$(".js-messages-check").length>0){var currentMessagesSelector=$(".js-messages-check"),currentMessagesBadgeSelector=$(".badge");setInterval(function(){var e=currentMessagesBadgeSelector.text();$.ajax({url:"/messages/check",type:"POST",data:{current_messages_count:e},success:function(e){"There's no new messages."!==e&&(currentMessagesSelector.hasClass("btn-info")?currentMessagesBadgeSelector.text(e):(currentMessagesSelector.removeClass("btn-default").addClass("btn-info").addClass("js-popover-new-messages"),currentMessagesSelector.html('Your messages <span class="badge">'+e+"</span>"),$(".js-popover-new-messages").popover({container:"body",placement:"top",trigger:"manual",content:"Inbox messages await the Operator."}).popover("show")))},error:function(){}})},3e4)}